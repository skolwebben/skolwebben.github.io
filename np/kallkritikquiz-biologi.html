<!DOCTYPE html>
<html lang="sv">
<head>
   <meta charset="UTF-8">
   <meta name="viewport" content="width=device-width, initial-scale=1.0">
   <title>Fysikquiz: Källkritik (Åk 9)</title>
   <!-- Importerar moderna fonter från Google Fonts -->
   <link rel="preconnect" href="https://fonts.googleapis.com">
   <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
   <link href="https://fonts.googleapis.com/css2?family=Open+Sans:wght@400;600&family=Poppins:wght@500;700&display=swap" rel="stylesheet">
  
   <style>
       :root {
           /* Färgpalett - Grönt Tema (Vetenskap/Natur) */
           --card-bg: #ffffff;
          
           --brand-color: #2e7d32; /* Mörkgrön */
           --brand-gradient: linear-gradient(135deg, #2e7d32 0%, #66bb6a 100%);
          
           --accent-color: #66bb6a; /* Ljusare grön */
          
           /* Komplementfärg: Terra Cotta / Bränd Orange */
           --complement-color: #d84315;


           --success-color: #2e7d32;
           --success-bg: #e8f5e9;
          
           --error-color: #c62828;
           --error-bg: #ffebee;
          
           --text-main: #212121; /* Mörkare grå/svart för text */
           --text-muted: #616161;
          
           --shadow-card: 0 10px 25px rgba(0,0,0,0.1);
           --shadow-hover: 0 6px 16px rgba(0,0,0,0.12);
           --radius-main: 16px;
       }


       body {
           font-family: 'Open Sans', sans-serif;
           /* Gråaktig fade (Silver/Metallic style) */
           background-image: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
           color: var(--text-main);
           margin: 0;
           padding: 15px;
           display: flex;
           justify-content: center;
           align-items: flex-start;
           min-height: 100vh;
       }


       .container {
           background-color: var(--card-bg);
           width: 100%;
           max-width: 680px;
           border-radius: var(--radius-main);
           box-shadow: var(--shadow-card);
           overflow: hidden;
           display: flex;
           flex-direction: column;
           position: relative;
           margin-top: 3vh;
           margin-bottom: 3vh;
       }


       header {
           background: var(--brand-gradient);
           color: white;
           padding: 20px;
           text-align: center;
           position: relative;
           overflow: hidden;
       }


       h1 {
           font-family: 'Poppins', sans-serif;
           margin: 0;
           font-size: 1.5rem;
           font-weight: 700;
           letter-spacing: -0.3px;
       }


       .content-area {
           padding: 25px 30px;
           flex-grow: 1;
       }


       h2 {
           font-family: 'Poppins', sans-serif;
           color: var(--text-main);
           margin-top: 0;
           font-size: 1.3rem;
           margin-bottom: 0.8rem;
           line-height: 1.3;
       }


       /* Fact Section Styles */
       .fact-box {
           background: #ffffff;
           border: 1px solid #eeeeee; /* Neutral border */
           border-radius: 12px;
           padding: 20px;
           margin-bottom: 20px;
           display: flex;
           gap: 15px;
           align-items: flex-start;
           box-shadow: 0 2px 8px rgba(0,0,0,0.03);
       }
      
       .fact-icon {
           font-size: 2rem;
           display: block;
           margin-top: -5px;
           color: var(--complement-color); /* Komplementfärg på ikonen */
       }
      
       .fact-content {
           flex: 1;
       }


       .btn {
           background: var(--brand-gradient);
           color: white;
           border: none;
           padding: 12px 24px;
           font-family: 'Poppins', sans-serif;
           font-size: 1rem;
           font-weight: 600;
           border-radius: 8px;
           cursor: pointer;
           transition: all 0.2s ease;
           display: block;
           width: 100%;
           margin-top: 20px;
           box-shadow: 0 4px 10px rgba(46, 125, 50, 0.2);
       }


       .btn:hover {
           transform: translateY(-2px);
           box-shadow: 0 6px 14px rgba(46, 125, 50, 0.3);
           opacity: 0.95;
       }


       /* Question Styles */
       .question-meta {
           display: inline-block;
           color: var(--complement-color); /* Komplementfärg */
           font-size: 0.85rem;
           margin-bottom: 10px;
           font-weight: 700;
           text-transform: uppercase;
           letter-spacing: 0.5px;
       }


       .options-grid {
           display: grid;
           gap: 12px;
           margin-top: 20px;
       }


       .option-btn {
           background-color: #fff;
           border: 2px solid #f5f5f5;
           padding: 15px 20px;
           text-align: left;
           border-radius: 10px;
           cursor: pointer;
           font-family: 'Open Sans', sans-serif;
           font-size: 0.95rem;
           font-weight: 500;
           transition: all 0.15s ease;
           color: var(--text-main);
           position: relative;
       }


       .option-btn:hover:not(:disabled) {
           border-color: var(--accent-color);
           background-color: #e8f5e9;
           transform: translateX(3px);
           box-shadow: 0 2px 5px rgba(0,0,0,0.05);
       }
      
       /* Status states for options */
       .option-btn.correct {
           background-color: var(--success-bg);
           border-color: var(--success-color);
           color: #1b5e20;
           font-weight: 600;
       }
      
       .option-btn.correct::after {
           content: "✓";
           position: absolute;
           right: 15px;
           font-weight: bold;
       }


       .option-btn.incorrect {
           background-color: var(--error-bg);
           border-color: var(--error-color);
           color: #b71c1c;
           opacity: 0.8;
       }


       .option-btn:disabled {
           cursor: default;
       }


       /* Feedback Box */
       .feedback-box {
           margin-top: 20px;
           padding: 20px 25px;
           border-radius: 12px;
           background-color: #f9f9f9;
           color: var(--text-main);
           border: 1px solid #e0e0e0;
           display: none;
           animation: fadeIn 0.3s ease;
       }
      
       .feedback-box h3 {
           margin-top: 0;
           font-family: 'Poppins', sans-serif;
           font-size: 1.2rem;
           display: flex;
           align-items: center;
           gap: 8px;
           margin-bottom: 8px;
       }


       .feedback-box.success h3 {
           color: var(--success-color);
       }
      
       .feedback-box.error h3 {
           color: var(--error-color);
       }


       .feedback-box strong {
           color: #000; /* Svarta fetstilade ord */
       }


       @keyframes fadeIn {
           from { opacity: 0; transform: translateY(5px); }
           to { opacity: 1; transform: translateY(0); }
       }


       /* Progress Bar Styles */
       .progress-bar-container {
           height: 6px;
           background-color: #eeeeee;
           width: 100%;
           position: relative;
           z-index: 10;
       }


       .progress-bar {
           height: 100%;
           /* Cyan Gradient */
           background: linear-gradient(90deg, #4facfe 0%, #00f2fe 100%);
           width: 0%;
           transition: width 0.5s cubic-bezier(0.34, 1.56, 0.64, 1);
           border-radius: 0 4px 4px 0;
           box-shadow: 0 0 10px rgba(79, 172, 254, 0.5);
       }


       /* Summary Styles */
       .summary-stats {
           text-align: center;
           background: linear-gradient(135deg, #e8f5e9 0%, #c8e6c9 100%);
           border: 1px solid #a5d6a7;
           padding: 30px 20px;
           border-radius: 12px;
           margin-bottom: 20px;
       }


       .summary-score {
           font-size: 3.5rem;
           font-family: 'Poppins', sans-serif;
           font-weight: 700;
           display: block;
           margin: 5px 0;
           line-height: 1;
           background: linear-gradient(135deg, #1b5e20 0%, #43a047 100%);
           -webkit-background-clip: text;
           -webkit-text-fill-color: transparent;
       }
      
       .summary-list {
           max-height: 400px;
           overflow-y: auto;
           padding-right: 10px;
       }
      
       .summary-item {
           background: white;
           border-bottom: 1px solid #eeeeee;
           padding: 12px 0;
       }
      
       .summary-item:last-child {
           border-bottom: none;
       }


       .summary-question {
           font-weight: 600;
           margin-bottom: 4px;
           display: block;
           font-size: 0.95rem;
       }
      
       .summary-answer-row {
           font-size: 0.9rem;
       }


       .summary-correct-text { color: var(--success-color); font-weight: 600; }
       .summary-wrong-text { color: var(--error-color); text-decoration: line-through; opacity: 0.8;}
       .real-answer { color: var(--success-color); font-weight: 600; margin-left: 5px; }


       /* Helpers */
       strong {
           color: #000; /* Svarta fetstilade ord */
           font-weight: 700;
       }


   </style>
</head>
<body>


<div class="container">
   <header>
       <h1 id="header-title">Fysikquiz: Källkritik</h1>
   </header>
   <div class="progress-bar-container">
       <div class="progress-bar" id="progress-bar"></div>
   </div>


   <div class="content-area" id="app">
       <!-- Content will be injected here by JavaScript -->
   </div>
</div>


<script>
   // --- DATA ---
   const quizData = [
       {
           title: "Del 1: Den vetenskapliga metoden",
           icon: "🔬",
           text: "En vetenskaplig undersökning måste vara <strong>reproducerbar</strong>. Det betyder att om en annan forskare gör om samma experiment ska resultatet bli detsamma. Forskare strävar också efter <strong>variabelkontroll</strong>. Det innebär att man i ett experiment bara ändrar en enda sak (t.ex. temperaturen) medan allt annat hålls lika. Om man har för få deltagare i en studie (<strong>litet urval</strong>) blir resultatet osäkert eftersom slumpen får för stor betydelse.",
           questions: [
               {
                   q: "Lisa vill testa om växter växer bäst med kaffe eller vatten. Hon häller kaffe på en kaktus i solen och vatten på en pelargon i skuggan. Vad är det största felet med hennes metod?",
                   options: [
                       "Kaktusar växer långsammare än pelargoner naturligt.",
                       "Hon ändrar flera variabler samtidigt (växt, vätska, ljus).",
                       "Hon borde ha använt te istället för kaffe i försöket.",
                       "Hon glömde att mäta hur mycket vätska hon hällde på."
                   ],
                   correct: 1,
                   explanation: "Eftersom hon ändrade allt på samma gång vet hon inte vad som orsakade resultatet. Det kan ha varit ljuset, växtsorten eller vätskan."
               },
               {
                   q: "Varför väljer forskare ofta att ha med hundratals eller tusentals personer i en medicinsk studie istället för bara tio?",
                   options: [
                       "För att det är billigare än att använda djurförsök.",
                       "För att det ser mer imponerande ut i tidningen.",
                       "För att läkarna behöver mycket att göra på dagarna.",
                       "För att minska risken att slumpen avgör resultatet."
                   ],
                   correct: 3,
                   explanation: "Med få deltagare kan en enda person som tillfrisknar av sig själv göra att medicinen verkar bättre än den är. Stora grupper jämnar ut slumpen."
               },
               {
                   q: "Vad innebär det att ett experiment är 'reproducerbart'?",
                   options: [
                       "Att resultatet är helt unikt och aldrig har hänt förut.",
                       "Att forskaren har skrivit ner resultatet i en rapport.",
                       "Att andra forskare kan göra om testet och få samma svar.",
                       "Att försöket måste filmas för att gälla som bevis."
                   ],
                   correct: 2,
                   explanation: "Om resultatet bara händer en gång och ingen kan upprepa det, räknas det inte som vetenskaplig fakta."
               }
           ]
       },
       {
           title: "Del 2: Källans trovärdighet och Jäv",
           icon: "⚖️",
           text: "När du läser forskning måste du granska avsändaren och syftet. Om ett företag betalar en studie som visar att deras egen produkt är bäst, finns risk för <strong>jäv</strong> (intressekonflikt). Det betyder att resultatet kan vara vinklat för att öka vinsten. Oberoende myndigheter (t.ex. <strong>Livsmedelsverket</strong>) anses ofta mer trovärdiga eftersom de inte har något vinstintresse. Innan studier publiceras i vetenskapliga tidskrifter genomgår de en <strong>Peer-review</strong> (fackgranskning) av experter.",
           questions: [
               {
                   q: "Du läser en artikel med rubriken 'Socker gör barn smartare'. Vem av följande författare bör du vara mest kritisk mot på grund av risk för jäv?",
                   options: [
                       "En tandläkare anställd av Folktandvården.",
                       "En representant från 'Sockerbolaget AB'.",
                       "En hjärnforskare vid Karolinska Institutet.",
                       "En journalist på tidningen Aftonbladet."
                   ],
                   correct: 1,
                   explanation: "Sockerbolaget tjänar pengar på att sälja socker. De har ett <strong>ekonomiskt intresse</strong> av att socker framställs som nyttigt."
               },
               {
                   q: "Varför anses information från en statlig myndighet, som Livsmedelsverket, ofta ha hög trovärdighet?",
                   options: [
                       "De har inget vinstintresse och arbetar på uppdrag av regeringen.",
                       "De har de snyggaste hemsidorna och de dyraste reklamfilmerna.",
                       "De bestämmer vilka matvaror som ska vara billiga i affären.",
                       "De anställer bara personer som har vunnit Nobelpriset."
                   ],
                   correct: 0,
                   explanation: "Deras syfte är att informera medborgarna <strong>objektivt</strong>, inte att sälja en produkt."
               },
               {
                   q: "Vad innebär begreppet 'Peer-review' (fackgranskning) inom forskarvärlden?",
                   options: [
                       "Att forskaren läser igenom sin egen text noga innan publicering.",
                       "Att allmänheten får rösta på internet om forskningen verkar bra.",
                       "Att tidningar skriver artiklar om studien så att alla får veta.",
                       "Att oberoende experter granskar studien för att hitta felaktigheter."
                   ],
                   correct: 3,
                   explanation: "Detta är vetenskapens kvalitetskontroll. Det stoppar dålig forskning och fusk från att publiceras i vetenskapliga tidskrifter."
               }
           ]
       },
       {
           title: "Del 3: Orsakssamband och Bevis",
           icon: "📈",
           text: "Bara för att två saker händer samtidigt (<strong>korrelation</strong>) betyder det inte att den ena orsakar den andra (<strong>kausalitet</strong>). Ett exempel: 'Både glassförsäljning och drunkningsolyckor ökar på sommaren'. Glass orsakar inte drunkning – värmen orsakar båda. Inom vetenskapen väger <strong>statistik</strong> tungt. Enskilda berättelser, så kallade <strong>anekdoter</strong> (t.ex. 'Min mormor rökte och blev 100 år'), bevisar ingenting eftersom de kan vara sällsynta undantag.",
           questions: [
               {
                   q: "En studie visar att barn som spelar mycket datorspel oftare har glasögon. Vad är en rimlig vetenskaplig tolkning av detta samband?",
                   options: [
                       "Strålningen från skärmen gör att ögat skadas omedelbart.",
                       "Glasögonen gör att barnen blir duktigare på att spela spel.",
                       "Det finns ett samband, men orsaken kan vara att de är inne mer.",
                       "Det är bevisat att alla som spelar spel kommer att få sämre syn."
                   ],
                   correct: 2,
                   explanation: "Ofta finns en <strong>bakomliggande orsak</strong> (t.ex. brist på dagsljus/utomhusvistelse) som påverkar synen, snarare än spelet i sig."
               },
               {
                   q: "Varför räcker det inte att säga 'Min farfar rökte hela livet och blev 95 år' för att bevisa att rökning är ofarligt?",
                   options: [
                       "För att farfar kanske inte drog halsbloss på riktigt.",
                       "För att cigaretter var mycket nyttigare förr i tiden.",
                       "För att gamla människor oftast har starkare lungor.",
                       "För att det är en anekdot som inte motbevisar statistiken."
                   ],
                   correct: 3,
                   explanation: "Vetenskap bygger på vad som händer för de flesta (<strong>statistik</strong>). Att det finns ett undantag ändrar inte fakta för den stora massan."
               }
           ]
       },
       {
           title: "Del 4: Pseudovetenskap",
           icon: "🔮",
           text: "<strong>Pseudovetenskap</strong> är påståenden som låter vetenskapliga men som saknar bevis. Typiska varningstecken är löften om mirakellösningar ('Denna frukt botar cancer!'), konspirationsteorier ('Läkarna döljer sanningen') eller att man använder svåra ord felaktigt ('Kvant-energi'). För att kontrollera om något stämmer bör man söka efter <strong>oberoende källor</strong> som inte försöker sälja något.",
           questions: [
               {
                   q: "Vilket av följande påståenden är en tydlig varningsklocka för att något kan vara pseudovetenskap (bluff)?",
                   options: [
                       "Vi behöver mer forskning för att veta säkert.",
                       "Denna hemliga metod botar alla dina sjukdomar.",
                       "Studien visar att risken minskar med cirka 5%.",
                       "Resultatet har publicerats i en vetenskaplig tidskrift."
                   ],
                   correct: 1,
                   explanation: "Löften om att bota 'allt' och användandet av ord som 'hemlig' är klassiska tecken på att det inte är seriös vetenskap."
               },
               {
                   q: "Du ser en annons för ett armband som sägs ge 'balans i kroppens energier'. Hur bör du göra för att granska påståendet?",
                   options: [
                       "Söka efter oberoende studier utanför företagets hemsida.",
                       "Läsa kommentarerna i annonsen för att se vad folk tycker.",
                       "Köpa armbandet och känna efter om du blir piggare.",
                       "Lita på det, det är olagligt att ljuga i reklam på nätet."
                   ],
                   correct: 0,
                   explanation: "Företaget vill sälja och visar bara positiva saker. <strong>Oberoende källor</strong> krävs för att få veta sanningen."
               }
           ]
       }
   ];


   // --- STATE MANAGEMENT ---
   let currentSectionIndex = 0;
   let currentQuestionIndex = 0; // Relative to current section
   let score = 0;
   let userAnswers = [];
   let state = 'intro'; // 'intro', 'question', 'summary'


   // --- DOM ELEMENTS ---
   const app = document.getElementById('app');
   const headerTitle = document.getElementById('header-title');
   const progressBar = document.getElementById('progress-bar');


   // --- MAIN RENDER FUNCTION ---
   function render() {
       if (state === 'summary') {
           renderSummary();
           return;
       }


       const section = quizData[currentSectionIndex];


       // Update Header with smooth fade
       headerTitle.style.opacity = '0';
       setTimeout(() => {
           headerTitle.innerText = section.title;
           headerTitle.style.transition = 'opacity 0.2s';
           headerTitle.style.opacity = '1';
       }, 150);


       // Calculate total progress
       let totalQuestions = 0;
       let answeredQuestions = 0;
      
       quizData.forEach((sec, idx) => {
           totalQuestions += sec.questions.length;
           if (idx < currentSectionIndex) {
               answeredQuestions += sec.questions.length;
           } else if (idx === currentSectionIndex && state === 'question') {
               answeredQuestions += currentQuestionIndex;
           }
       });
       const pct = (answeredQuestions / totalQuestions) * 100;
       progressBar.style.width = `${pct}%`;


       if (state === 'intro') {
           renderSectionIntro(section);
       } else if (state === 'question') {
           renderQuestion(section.questions[currentQuestionIndex]);
       }
   }


   // --- RENDER SECTION TEXT ---
   function renderSectionIntro(section) {
       // Simple animation class reset
       app.classList.remove('fade-in');
       void app.offsetWidth; // trigger reflow
       app.classList.add('fade-in');


       app.innerHTML = `
           <div class="fact-box">
               <span class="fact-icon">${section.icon}</span>
               <div class="fact-content">
                   <h2>Fakta</h2>
                   <p style="line-height: 1.6; font-size: 1rem; margin-top:0;">${section.text}</p>
               </div>
           </div>
           <button class="btn" onclick="startQuestions()">Starta frågor för denna del</button>
       `;
   }


   // --- RENDER QUESTION ---
   function renderQuestion(q) {
       const totalInCurrent = quizData[currentSectionIndex].questions.length;
      
       // Render with reset styles for feedback box
       app.innerHTML = `
           <div class="question-meta">Del ${currentSectionIndex + 1} • Fråga ${currentQuestionIndex + 1}/${totalInCurrent}</div>
           <h2 style="color: var(--text-main); font-weight: 600; margin-bottom:15px;">${q.q}</h2>
           <div class="options-grid">
               ${q.options.map((opt, idx) => `
                   <button class="option-btn" onclick="handleAnswer(${idx})" id="opt-${idx}">${opt}</button>
               `).join('')}
           </div>
           <div id="feedback" class="feedback-box">
               <h3 id="feedback-title"></h3>
               <p id="feedback-text" style="margin: 5px 0 15px 0; font-size: 0.95rem; line-height: 1.6;"></p>
               <button class="btn" id="next-btn" onclick="nextStep()" style="margin-top:0; width: auto; min-width: 150px;">Nästa fråga ➔</button>
           </div>
       `;
   }


   // --- RENDER SUMMARY ---
   function renderSummary() {
       headerTitle.innerText = "Sammanfattning";
       progressBar.style.width = '100%';
      
       let totalQ = 0;
       quizData.forEach(s => totalQ += s.questions.length);
      
       // Calculate score
       let correctCount = userAnswers.filter(a => a.isCorrect).length;
       let pct = Math.round((correctCount / totalQ) * 100);
      
       let gradeTitle = "";
      
       if(pct > 90) { gradeTitle = "Fantastiskt bra! 🏆"; }
       else if(pct > 70) { gradeTitle = "Mycket bra jobbat! 🌟"; }
       else if(pct > 50) { gradeTitle = "Godkänt! 👍"; }
       else { gradeTitle = "Fortsätt kämpa! 💪"; }


       let html = `
           <div class="summary-stats">
               <h2 style="color:var(--brand-color); margin:0 0 10px 0;">${gradeTitle}</h2>
               <span class="summary-score">${correctCount}/${totalQ}</span>
               <span style="color:#666; font-size: 0.9rem; text-transform: uppercase; letter-spacing: 1px;">Rätt svar</span>
               <button class="btn" onclick="location.reload()" style="background: transparent; border: 2px solid var(--accent-color); color: var(--accent-color); margin-top: 20px; box-shadow:none; width: auto; padding: 10px 30px;">Gör om testet</button>
           </div>
           <h3 style="margin: 0 0 10px 0; font-size: 1.1rem; color: var(--text-muted);">Dina svar:</h3>
           <div class="summary-list">
       `;


       userAnswers.forEach((ans, idx) => {
           const isCorrect = ans.isCorrect;
          
           html += `
               <div class="summary-item">
                   <span class="summary-question">${idx + 1}. ${ans.question}</span>
                   <div class="summary-answer-row">
                       ${isCorrect
                           ? `<span class="summary-correct-text">✔ ${ans.userAnswer}</span>`
                           : `<span class="summary-wrong-text">✖ ${ans.userAnswer}</span> <span style="margin: 0 5px; color:#999;">➔</span> <span class="real-answer">${ans.correctAnswer}</span>`
                       }
                   </div>
               </div>
           `;
       });


       html += `</div>`;
       app.innerHTML = html;
   }


   // --- LOGIC FUNCTIONS ---
   window.startQuestions = function() {
       state = 'question';
       currentQuestionIndex = 0;
       render();
   };


   window.handleAnswer = function(selectedIndex) {
       // Disable all buttons
       const buttons = document.querySelectorAll('.option-btn');
       buttons.forEach(b => b.disabled = true);


       const section = quizData[currentSectionIndex];
       const currentQ = section.questions[currentQuestionIndex];
       const isCorrect = selectedIndex === currentQ.correct;


       // Visual feedback on buttons
       const selectedBtn = document.getElementById(`opt-${selectedIndex}`);
       const correctBtn = document.getElementById(`opt-${currentQ.correct}`);


       if (isCorrect) {
           selectedBtn.classList.add('correct');
       } else {
           selectedBtn.classList.add('incorrect');
           correctBtn.classList.add('correct'); // Show which one was right
       }


       // Show feedback box
       const feedbackBox = document.getElementById('feedback');
       const feedbackTitle = document.getElementById('feedback-title');
       const feedbackText = document.getElementById('feedback-text');
       const nextBtn = document.getElementById('next-btn');


       feedbackBox.style.display = 'block';
      
       // Add class for success/error styling
       if (isCorrect) {
           feedbackBox.className = "feedback-box success";
           feedbackTitle.innerHTML = "Rätt svar!";
       } else {
           feedbackBox.className = "feedback-box error";
           feedbackTitle.innerHTML = "Inte riktigt...";
       }
      
       feedbackText.innerHTML = currentQ.explanation; // Use innerHTML to render <strong> tags


       // Check if last question of entire quiz
       const isLastQuestionOverall = (currentSectionIndex === quizData.length - 1) && (currentQuestionIndex === section.questions.length - 1);
      
       if(isLastQuestionOverall) {
           nextBtn.innerText = "Se resultat 🏁";
       } else if (currentQuestionIndex === section.questions.length - 1) {
           nextBtn.innerText = "Nästa del ➔";
       }


       // Scroll to feedback if needed on mobile, but gently
       const rect = feedbackBox.getBoundingClientRect();
       const isVisible = (rect.top >= 0) && (rect.bottom <= window.innerHeight);
       if (!isVisible) {
            setTimeout(() => {
               feedbackBox.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
           }, 100);
       }


       // Save data
       userAnswers.push({
           question: currentQ.q,
           userAnswer: currentQ.options[selectedIndex],
           correctAnswer: currentQ.options[currentQ.correct],
           isCorrect: isCorrect
       });
   };


   window.nextStep = function() {
       const section = quizData[currentSectionIndex];
      
       // Reset feedback styles for next render
       const feedbackBox = document.getElementById('feedback');
       if(feedbackBox) {
           feedbackBox.style.display = 'none';
       }


       // Check if there are more questions in this section
       if (currentQuestionIndex < section.questions.length - 1) {
           currentQuestionIndex++;
           render();
       } else {
           // End of section, move to next section
           if (currentSectionIndex < quizData.length - 1) {
               currentSectionIndex++;
               state = 'intro';
               render();
           } else {
               // End of quiz
               state = 'summary';
               render();
           }
       }
   };


   // --- INIT ---
   render();


</script>


</body>
</html>