<!DOCTYPE html>
	<html lang="sv">
	<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Biologiquiz: Ekologi & Hållbarhet (Åk 9)</title>
	<!-- Importerar moderna fonter från Google Fonts -->
	<link rel="preconnect" href="https://fonts.googleapis.com">
	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link href="https://fonts.googleapis.com/css2?family=Open+Sans:wght@400;600&family=Poppins:wght@500;700&display=swap" rel="stylesheet">
	

	<style>
	:root {
	/* Färgpalett - Grönt Tema med Komplement */
	--card-bg: #ffffff;
	

	--brand-color: #2e7d32; /* Basgrön */
	--brand-gradient: linear-gradient(135deg, #2e7d32 0%, #66bb6a 100%);
	

	--accent-color: #66bb6a;
	

	/* Komplementfärg: Terra Cotta / Bränd Orange */
	--complement-color: #d84315;
	

	

	--success-color: #2e7d32;
	--success-bg: #e8f5e9;
	

	--error-color: #c62828;
	--error-bg: #ffebee;
	

	--text-main: #212121; /* Mörkare grå/svart för text */
	--text-muted: #616161;
	

	--shadow-card: 0 10px 25px rgba(0,0,0,0.1);
	--shadow-hover: 0 6px 16px rgba(0,0,0,0.12);
	--radius-main: 16px;
	}
	

	

	body {
	font-family: 'Open Sans', sans-serif;
	/* Mer neutral bakgrund (ljusgrå/vit) med svag grön ton */
	background-image: linear-gradient(135deg, #f5f5f5 0%, #e8f5e9 100%);
	color: var(--text-main);
	margin: 0;
	padding: 15px;
	display: flex;
	justify-content: center;
	align-items: flex-start;
	min-height: 100vh;
	}
	

	

	.container {
	background-color: var(--card-bg);
	width: 100%;
	max-width: 680px;
	border-radius: var(--radius-main);
	box-shadow: var(--shadow-card);
	overflow: hidden;
	display: flex;
	flex-direction: column;
	position: relative;
	margin-top: 3vh;
	margin-bottom: 3vh;
	}
	

	

	header {
	background: var(--brand-gradient);
	color: white;
	padding: 20px;
	text-align: center;
	position: relative;
	overflow: hidden;
	}
	

	

	h1 {
	font-family: 'Poppins', sans-serif;
	margin: 0;
	font-size: 1.5rem;
	font-weight: 700;
	letter-spacing: -0.3px;
	}
	

	

	.content-area {
	padding: 25px 30px;
	flex-grow: 1;
	}
	

	

	h2 {
	font-family: 'Poppins', sans-serif;
	color: var(--text-main);
	margin-top: 0;
	font-size: 1.3rem;
	margin-bottom: 0.8rem;
	line-height: 1.3;
	}
	

	

	/* Fact Section Styles */
	.fact-box {
	background: #ffffff;
	border: 1px solid #eeeeee;
	border-radius: 12px;
	padding: 20px;
	margin-bottom: 20px;
	display: flex;
	gap: 15px;
	align-items: flex-start;
	box-shadow: 0 2px 8px rgba(0,0,0,0.03);
	}
	

	.fact-icon {
	font-size: 2rem;
	display: block;
	margin-top: -5px;
	color: var(--complement-color); /* Komplementfärg på ikonen */
	}
	

	.fact-content {
	flex: 1;
	}
	

	

	.btn {
	background: var(--brand-gradient);
	color: white;
	border: none;
	padding: 12px 24px;
	font-family: 'Poppins', sans-serif;
	font-size: 1rem;
	font-weight: 600;
	border-radius: 8px;
	cursor: pointer;
	transition: all 0.2s ease;
	display: block;
	width: 100%;
	margin-top: 20px;
	box-shadow: 0 4px 10px rgba(46, 125, 50, 0.2);
	}
	

	

	.btn:hover {
	transform: translateY(-2px);
	box-shadow: 0 6px 14px rgba(46, 125, 50, 0.3);
	opacity: 0.95;
	}
	

	

	/* Question Styles */
	.question-meta {
	display: inline-block;
	color: var(--complement-color); /* Subtil användning av komplementfärgen */
	font-size: 0.85rem;
	margin-bottom: 10px;
	font-weight: 700;
	text-transform: uppercase;
	letter-spacing: 0.5px;
	}
	

	

	.options-grid {
	display: grid;
	gap: 12px;
	margin-top: 20px;
	}
	

	

	.option-btn {
	background-color: #fff;
	border: 2px solid #f5f5f5;
	padding: 15px 20px;
	text-align: left;
	border-radius: 10px;
	cursor: pointer;
	font-family: 'Open Sans', sans-serif;
	font-size: 0.95rem;
	font-weight: 500;
	transition: all 0.15s ease;
	color: var(--text-main);
	position: relative;
	}
	

	

	.option-btn:hover:not(:disabled) {
	border-color: var(--accent-color);
	background-color: #f1f8e9;
	transform: translateX(3px);
	box-shadow: 0 2px 5px rgba(0,0,0,0.05);
	}
	

	/* Status states for options */
	.option-btn.correct {
	background-color: var(--success-bg);
	border-color: var(--success-color);
	color: #1b5e20;
	font-weight: 600;
	}
	

	.option-btn.correct::after {
	content: "✓";
	position: absolute;
	right: 15px;
	font-weight: bold;
	}
	

	

	.option-btn.incorrect {
	background-color: var(--error-bg);
	border-color: var(--error-color);
	color: #b71c1c;
	opacity: 0.8;
	}
	

	

	.option-btn:disabled {
	cursor: default;
	}
	

	

	/* Feedback Box */
	.feedback-box {
	margin-top: 20px;
	padding: 20px 25px;
	border-radius: 12px;
	background-color: #f9f9f9;
	color: var(--text-main);
	border: 1px solid #e0e0e0;
	display: none;
	animation: fadeIn 0.3s ease;
	}
	

	.feedback-box h3 {
	margin-top: 0;
	font-family: 'Poppins', sans-serif;
	font-size: 1.2rem;
	display: flex;
	align-items: center;
	gap: 8px;
	margin-bottom: 8px;
	}
	

	

	.feedback-box.success h3 {
	color: var(--success-color);
	}
	

	.feedback-box.error h3 {
	color: var(--error-color);
	}
	

	

	.feedback-box strong {
	color: #000; /* Svart för tydlighet i feedback */
	}
	

	

	@keyframes fadeIn {
	from { opacity: 0; transform: translateY(5px); }
	to { opacity: 1; transform: translateY(0); }
	}
	

	

	/* Progress Bar Styles */
	.progress-bar-container {
	height: 6px;
	background-color: #eeeeee;
	width: 100%;
	position: relative;
	z-index: 10;
	}
	

	

	.progress-bar {
	height: 100%;
	/* Grön gradient */
	background: linear-gradient(90deg, #66bb6a 0%, #2e7d32 100%);
	width: 0%;
	transition: width 0.5s cubic-bezier(0.34, 1.56, 0.64, 1);
	border-radius: 0 4px 4px 0;
	box-shadow: 0 0 10px rgba(76, 175, 80, 0.5);
	}
	

	

	/* Summary Styles */
	.summary-stats {
	text-align: center;
	background: linear-gradient(135deg, #f1f8e9 0%, #dcedc8 100%);
	border: 1px solid #c5e1a5;
	padding: 30px 20px;
	border-radius: 12px;
	margin-bottom: 20px;
	}
	

	

	.summary-score {
	font-size: 3.5rem;
	font-family: 'Poppins', sans-serif;
	font-weight: 700;
	display: block;
	margin: 5px 0;
	line-height: 1;
	background: linear-gradient(135deg, #1b5e20 0%, #43a047 100%);
	-webkit-background-clip: text;
	-webkit-text-fill-color: transparent;
	}
	

	.summary-list {
	max-height: 400px;
	overflow-y: auto;
	padding-right: 10px;
	}
	

	.summary-item {
	background: white;
	border-bottom: 1px solid #eeeeee;
	padding: 12px 0;
	}
	

	.summary-item:last-child {
	border-bottom: none;
	}
	

	

	.summary-question {
	font-weight: 600;
	margin-bottom: 4px;
	display: block;
	font-size: 0.95rem;
	}
	

	.summary-answer-row {
	font-size: 0.9rem;
	}
	

	

	.summary-correct-text { color: var(--success-color); font-weight: 600; }
	.summary-wrong-text { color: var(--error-color); text-decoration: line-through; opacity: 0.8;}
	.real-answer { color: var(--success-color); font-weight: 600; margin-left: 5px; }
	

	

	/* Helpers */
	strong {
	color: #000; /* Svarta fetstilade ord */
	font-weight: 700;
	}
	

	

	</style>
	</head>
	<body>
	

	

	<div class="container">
	<header>
	<h1 id="header-title">Biologiquiz: Ekologi & Hållbarhet</h1>
	</header>
	<div class="progress-bar-container">
	<div class="progress-bar" id="progress-bar"></div>
	</div>
	

	

	<div class="content-area" id="app">
	<!-- Content will be injected here by JavaScript -->
	</div>
	</div>
	

	

	<script>
	// --- DATA —


const quizData = [
   {
       title: "Del 1: Ekosystemets grunder",
       icon: "🌲",
       text: "<strong>Ekologi</strong> beskriver samspelet mellan organismer och deras miljö. Ett <strong>ekosystem</strong> är ett avgränsat område där detta samspel sker. <strong>Abiotiska faktorer</strong> är icke-levande ting som påverkar, t.ex. temperatur och ljus. <strong>Biotiska faktorer</strong> är levande påverkan, som mat och konkurrens. Alla individer av samma art inom ekosystemet kallas för en <strong>population</strong>.",
       questions: [
           {
               q: "Vad är ett exempel på abiotiska faktorer i en skog?",
               options: [
                   "Alla levande växter, träd, buskar, mossor och djur som finns i skogen", // Längst
                   "Samspelet mellan rovdjur och bytesdjur",
                   "Icke-levande faktorer som ljus, vind och temperatur", // Rätt (Mellan)
                   "Bakterier i marken" // Kortast
               ],
               correct: 2,
               explanation: "<strong>Abiotiska faktorer</strong> är de delar av ekosystemet som inte lever, men som ändå påverkar vilka djur och växter som trivs där."
           },
           {
               q: "Vad menas med en population inom biologin?",
               options: [
                   "Alla individer av samma art inom ett visst område", // Rätt (Mellan)
                   "Alla olika djurarter, växter och svampar som lever tillsammans i skogen", // Längst
                   "En liten grupp djur", // Kortast
                   "Den sammanlagda vikten av allt levande i skogen"
               ],
               correct: 0,
               explanation: "En <strong>population</strong> handlar om *en* specifik art på en plats, till exempel alla gäddor i en sjö eller alla tallar på en myr."
           },
           {
               q: "Vilken ordning stämmer för livets utveckling på jorden?",
               options: [
                   "Liv på land → Syrgas bildas i atmosfären → Fotosyntes utvecklas",
                   "Syrgas bildas → Liv på land → Fotosyntes sker i haven",
                   "Liv på land → Fotosyntes → Syrgas bildas",
                   "Fotosyntes → Syrgas bildas → Liv på land" // Rätt (Kortast)
               ],
               correct: 3,
               explanation: "Först kom <strong>fotosyntesen</strong> i havet. Den skapade syre (syrgas), som i sin tur byggde upp ozonlagret så att liv kunde klara sig uppe på land."
           }
       ]
   },
   {
       title: "Del 2: Fotosyntes & Cellandning",
       icon: "🍃",
       text: "<strong>Fotosyntesen</strong> sker i växternas gröna blad där solljus, vatten och koldioxid omvandlas till <strong>druvsocker</strong> och <strong>syre</strong>. Detta är grunden för nästan allt liv. <strong>Cellandning</strong> (förbränning) är fotosyntesen baklänges: cellerna använder socker och syre för att utvinna energi, och bildar då koldioxid och vatten.",
       questions: [
           {
               q: "Vilka ämnen tillverkar växten i fotosyntesen?",
               options: [
                   "Koldioxid, vattenånga och en stor mängd spillvärme", // Längst
                   "Druvsocker (energi) och syrgas", // Rätt (Mellan)
                   "Bara vatten", // Kortast
                   "Jord, koldioxid och värme från solen"
               ],
               correct: 1,
               explanation: "Växten använder solens energi för att bygga ihop koldioxid och vatten till <strong>druvsocker</strong>. Syret blir över och släpps ut."
           },
           {
               q: "Vad behöver dina celler för att cellandningen ska fungera?",
               options: [
                   "Koldioxid och värme", // Kortast
                   "Solljus, vatten och grönt klorofyll",
                   "Druvsocker som bränsle samt syre från luften", // Rätt (Längst)
                   "Vatten och koldioxidgas"
               ],
               correct: 2,
               explanation: "<strong>Cellandning</strong> är som en förbränning inuti kroppen. För att få energi behöver cellerna bränsle (socker) och syre."
           },
           {
               q: "Vilken gas ökar i luften när vi andas ut (cellandning)?",
               options: [
                   "Koldioxid, som vi andas ut", // Rätt (Mellan)
                   "Syrgas, som alla kroppens celler vill ha", // Längst
                   "Kväve", // Kortast
                   "Vattenånga, som vi svettas ut"
               ],
               correct: 0,
               explanation: "När cellerna förbränner sockret bildas <strong>koldioxid</strong> som en restprodukt (avgas), som vi sedan andas ut."
           }
       ]
   },
   {
       title: "Del 3: Energiflöden & Kretslopp",
       icon: "♻️",
       text: "Energi flödar genom ekosystemet och kommer ursprungligen från solen. I varje steg i en <strong>näringskedja</strong> försvinner ca 90 % av energin som värme; endast <strong>10 %</strong> går vidare. Materia, som kol, cirkulerar däremot i <strong>kretslopp</strong>. Kolet binds i växter genom fotosyntes och återgår till luften genom cellandning eller förbränning.",
       questions: [
           {
               q: "Varför finns det färre lejon än zebror på savannen?",
               options: [
                   "Lejon förökar sig extremt mycket långsammare än vad zebrorna hinner göra", // Längst
                   "Zebrorna konkurrerar ut lejonen om boplatser",
                   "Sjukdomar", // Kortast
                   "Det mesta av energin förloras som värme i varje steg" // Rätt (Mellan)
               ],
               correct: 3,
               explanation: "Energin tar slut! I varje steg i näringskedjan försvinner ca 90% av energin som kroppsvärme och rörelse. Det räcker bara till ett fåtal rovdjur i toppen."
           },
           {
               q: "Vad händer med kolet i ett träd när det dör och ruttnar?",
               options: [
                   "Det försvinner helt och hållet från planetens yta", // Längst
                   "Det blir till koldioxid i luften", // Rätt (Kortast)
                   "Det lagras i marken för alltid som sten",
                   "Det omvandlas direkt till ren solenergi"
               ],
               correct: 1,
               explanation: "Nedbrytare (svampar och maskar) äter trädet. När de andas (cellandning) släpper de ut kolet som <strong>koldioxid</strong> igen."
           },
           {
               q: "Vad måste alltid finnas först i en näringskedja?",
               options: [
                   "En stor växtätare som äter mycket gräs", // Längst
                   "Ett rovdjur", // Kortast
                   "En producent (t.ex. en växt)", // Rätt (Mellan)
                   "En nedbrytare som äter dött"
               ],
               correct: 2,
               explanation: "Kedjan måste börja med någon som kan fånga solenergi. Det är bara <strong>producenter</strong> (växter) som kan göra det."
           }
       ]
   },
   {
       title: "Del 4: Populationer och Balans",
       icon: "⚖️",
       text: "I ett stabilt ekosystem finns en balans. Om antalet bytesdjur ökar, ökar även antalet rovdjur. <strong>Begränsande faktorer</strong> för en population kan vara mat, boplatser och rovdjur. <strong>Konkurrens</strong> uppstår när resurserna inte räcker. En arts speciella 'yrke' eller behov kallas dess <strong>ekologiska nisch</strong>.",
       questions: [
           {
               q: "Tänk dig kedjan: Plankton → Småfisk → Torsk. Vad händer om torsken försvinner?",
               options: [
                   "Mängden småfisk ökar väldigt kraftigt då ingen längre äter upp dem", // Rätt (Längst)
                   "Mängden växtplankton ökar lite", // Kortast
                   "Hela ekosystemet dör ut inom en vecka",
                   "Småfisken minskar eftersom maten tar slut"
               ],
               correct: 0,
               explanation: "Om rovdjuret försvinner är det ingen som håller efter bytesdjuren (småfisken). Då blir de fler, vilket i sin tur kan leda till att planktonen tar slut."
           },
           {
               q: "Vad är det som oftast hindrar en population från att växa för evigt?",
               options: [
                   "Att solljuset inte räcker till för att värma upp alla djuren på vintern", // Längst
                   "Att djuren tröttnar på att para sig med varandra",
                   "Att det blir alldeles för mycket syre i luften",
                   "Matbrist eller rovdjur" // Rätt (Kortast)
               ],
               correct: 3,
               explanation: "Det kallas för <strong>begränsande faktorer</strong>. Maten tar slut, sjukdomar sprids lättare när de är många, eller så äter rovdjuren upp dem."
           },
           {
               q: "Vad menas med en ekologisk nisch?",
               options: [
                   "Den exakta platsen i skogen där djuret bygger sitt bo och sover om natten", // Längst
                   "Artens speciella 'yrke' och behov i naturen", // Rätt (Mellan)
                   "Ett helt tomt område", // Kortast
                   "När två arter bråkar om samma mat"
               ],
               correct: 1,
               explanation: "En <strong>nisch</strong> är artens specialitet (t.ex. att jaga på natten eller äta barr). Det gör att olika arter kan leva i samma skog utan att konkurrera för mycket."
           }
       ]
   },
   {
       title: "Del 5: Människan & Hållbarhet",
       icon: "🌍",
       text: "Människans påverkan är global. <strong>Övergödning</strong> orsakas av utsläpp av närsalter, vilket leder till algblomning. <strong>Biologisk mångfald</strong> ger stabila ekosystem. <strong>Ekosystemtjänster</strong> är gratistjänster från naturen, t.ex. pollinering. Ett <strong>ekologiskt fotavtryck</strong> mäter hur mycket resurser vi använder.",
       questions: [
           {
               q: "Vilka ämnen är den största orsaken till övergödning i havet?",
               options: [
                   "Olja, bensin och diesel som läcker ut från stora fartyg", // Längst
                   "Plast och skräp som slängs på stranden",
                   "Kväve och fosfor", // Rätt (Kortast)
                   "Koldioxid som löses upp i havsvattnet"
               ],
               correct: 2,
               explanation: "Kväve och fosfor fungerar som gödning för algerna. Det kommer ofta från jordbrukets gödsel eller våra avlopp."
           },
           {
               q: "Vad är en ekosystemtjänst?",
               options: [
                   "Gratistjänster från naturen, t.ex. pollinering", // Rätt (Mellan)
                   "När vi människor går ut och städar upp allt skräp i naturen", // Längst
                   "Lagar om djur", // Kortast
                   "Avgifter som företag betalar för utsläpp"
               ],
               correct: 0,
               explanation: "Det är allt 'gratisjobb' naturen gör åt oss. Utan pollinering får vi ingen frukt, och utan våtmarker renas inte vattnet lika bra."
           },
           {
               q: "Varför är det bra med hög biologisk mångfald (många olika arter)?",
               options: [
                   "Det blir vackrare", // Kortast
                   "Det blir lättare att jaga och fiska",
                   "Det minskar risken för nya arter",
                   "Ekosystemet blir mer stabilt och tål förändringar, som ett skyddsnät" // Rätt (Längst)
               ],
               correct: 3,
               explanation: "Om det finns många arter fungerar naturen som ett skyddsnät. Om en art dör ut kan ofta en annan ta över dess uppgift."
           },
           {
               q: "Varför har torsken i Östersjön minskat så kraftigt?",
               options: [
                   "Sälarna har blivit alldeles för många och har ätit upp precis all fisk som finns", // Längst
                   "Överfiske och syrebrist på havsbotten", // Rätt (Mellan)
                   "Vattnet är för varmt", // Kortast
                   "Torsken har flyttat till andra hav"
               ],
               correct: 1,
               explanation: "Det är en kombination. <strong>Överfiske</strong> tar bort de vuxna fiskarna, och syrebrist på botten (pga övergödning) gör att äggen dör."
           },
           {
               q: "Vad visar vårt 'ekologiska fotavtryck'?",
               options: [
                   "Hur mycket koldioxid vi andas ut",
                   "Hur mycket sopor, plast och annat skräp vi slänger direkt i naturen", // Längst
                   "Hur stor yta av jorden som vår livsstil kräver", // Rätt (Mellan)
                   "Hur långt vi går", // Kortast
               ],
               correct: 2,
               explanation: "Det visar hur många jordklot som skulle krävas om alla levde som du. I Sverige lever vi som om vi hade ca 4 jordklot."
           },
           {
               q: "Varför är bönor och ärtor (baljväxter) extra bra för miljön?",
               options: [
                   "De kan fånga kväve direkt från luften och använda som egen gödning", // Rätt (Längst)
                   "De behöver inget vatten", // Kortast
                   "De växer snabbare än alla andra grönsaker",
                   "De smakar bättre än kött och är billigare"
               ],
               correct: 0,
               explanation: "Baljväxter samarbetar med bakterier som fångar kväve direkt från luften. Då behöver bonden inte köra ut lika mycket konstgödsel."
           },
           {
               q: "Vad är en invasiv art?",
               options: [
                   "En art som människan tyvärr har utrotat helt",
                   "En art som är fridlyst", // Kortast
                   "En art som bara lever i gammal skog",
                   "En främmande art som människan flyttat hit och som skadar den lokala naturen" // Rätt (Längst)
               ],
               correct: 3,
               explanation: "Exempel är mördarsnigel eller lupiner. De hör inte hemma här, saknar naturliga fiender och konkurrerar ut våra vanliga svenska arter."
           },
           {
               q: "Varför är biobränsle (från växter) bättre för klimatet än bensin?",
               options: [
                   "Det släpper inte ut några som helst avgaser eller partiklar i luften", // Längst
                   "Det ingår i kolets kretslopp", // Rätt (Kortast)
                   "Det är mycket billigare att framställa än bensin",
                   "Det renar luften från avgaser när man kör"
               ],
               correct: 1,
               explanation: "Båda släpper ut koldioxid. Men biobränslets koldioxid togs nyss upp av växten. Bensin tillför *nytt* kol som legat gömt i marken i miljoner år."
           }
       ]
   }
];


	// --- STATE MANAGEMENT ---
	let currentSectionIndex = 0;
	let currentQuestionIndex = 0; // Relative to current section
	let score = 0;
	let userAnswers = [];
	let state = 'intro'; // 'intro', 'question', 'summary'
	

	

	// --- DOM ELEMENTS ---
	const app = document.getElementById('app');
	const headerTitle = document.getElementById('header-title');
	const progressBar = document.getElementById('progress-bar');
	

	

	// --- MAIN RENDER FUNCTION ---
	function render() {
	if (state === 'summary') {
	renderSummary();
	return;
	}
	

	

	const section = quizData[currentSectionIndex];
	

	

	// Update Header with smooth fade
	headerTitle.style.opacity = '0';
	setTimeout(() => {
	headerTitle.innerText = section.title;
	headerTitle.style.transition = 'opacity 0.2s';
	headerTitle.style.opacity = '1';
	}, 150);
	

	

	// Calculate total progress
	let totalQuestions = 0;
	let answeredQuestions = 0;
	

	quizData.forEach((sec, idx) => {
	totalQuestions += sec.questions.length;
	if (idx < currentSectionIndex) {
	answeredQuestions += sec.questions.length;
	} else if (idx === currentSectionIndex && state === 'question') {
	answeredQuestions += currentQuestionIndex;
	}
	});
	const pct = (answeredQuestions / totalQuestions) * 100;
	progressBar.style.width = `${pct}%`;
	

	

	if (state === 'intro') {
	renderSectionIntro(section);
	} else if (state === 'question') {
	renderQuestion(section.questions[currentQuestionIndex]);
	}
	}
	

	

	// --- RENDER SECTION TEXT ---
	function renderSectionIntro(section) {
	// Simple animation class reset
	app.classList.remove('fade-in');
	void app.offsetWidth; // trigger reflow
	app.classList.add('fade-in');
	

	

	app.innerHTML = `
	<div class="fact-box">
	<span class="fact-icon">${section.icon}</span>
	<div class="fact-content">
	<h2>Fakta</h2>
	<p style="line-height: 1.6; font-size: 1rem; margin-top:0;">${section.text}</p>
	</div>
	</div>
	<button class="btn" onclick="startQuestions()">Starta frågor för denna del</button>
	`;
	}
	

	

	// --- RENDER QUESTION ---
	function renderQuestion(q) {
	const totalInCurrent = quizData[currentSectionIndex].questions.length;
	

	// Render with reset styles for feedback box
	app.innerHTML = `
	<div class="question-meta">Del ${currentSectionIndex + 1} • Fråga ${currentQuestionIndex + 1}/${totalInCurrent}</div>
	<h2 style="color: var(--text-main); font-weight: 600; margin-bottom:15px;">${q.q}</h2>
	<div class="options-grid">
	${q.options.map((opt, idx) => `
	<button class="option-btn" onclick="handleAnswer(${idx})" id="opt-${idx}">${opt}</button>
	`).join('')}
	</div>
	<div id="feedback" class="feedback-box">
	<h3 id="feedback-title"></h3>
	<p id="feedback-text" style="margin: 5px 0 15px 0; font-size: 0.95rem; line-height: 1.6;"></p>
	<button class="btn" id="next-btn" onclick="nextStep()" style="margin-top:0; width: auto; min-width: 150px;">Nästa fråga ➔</button>
	</div>
	`;
	}
	

	

	// --- RENDER SUMMARY ---
	function renderSummary() {
	headerTitle.innerText = "Sammanfattning";
	progressBar.style.width = '100%';
	

	let totalQ = 0;
	quizData.forEach(s => totalQ += s.questions.length);
	

	// Calculate score
	let correctCount = userAnswers.filter(a => a.isCorrect).length;
	let pct = Math.round((correctCount / totalQ) * 100);
	

	let gradeTitle = "";
	

	if(pct > 90) { gradeTitle = "Fantastiskt bra! 🏆"; }
	else if(pct > 70) { gradeTitle = "Mycket bra jobbat! 🌟"; }
	else if(pct > 50) { gradeTitle = "Godkänt! 👍"; }
	else { gradeTitle = "Fortsätt kämpa! 💪"; }
	

	

	let html = `
	<div class="summary-stats">
	<h2 style="color:var(--brand-color); margin:0 0 10px 0;">${gradeTitle}</h2>
	<span class="summary-score">${correctCount}/${totalQ}</span>
	<span style="color:#666; font-size: 0.9rem; text-transform: uppercase; letter-spacing: 1px;">Rätt svar</span>
	<button class="btn" onclick="location.reload()" style="background: transparent; border: 2px solid var(--accent-color); color: var(--accent-color); margin-top: 20px; box-shadow:none; width: auto; padding: 10px 30px;">Gör om testet</button>
	</div>
	<h3 style="margin: 0 0 10px 0; font-size: 1.1rem; color: var(--text-muted);">Dina svar:</h3>
	<div class="summary-list">
	`;
	

	

	userAnswers.forEach((ans, idx) => {
	const isCorrect = ans.isCorrect;
	

	html += `
	<div class="summary-item">
	<span class="summary-question">${idx + 1}. ${ans.question}</span>
	<div class="summary-answer-row">
	${isCorrect
	? `<span class="summary-correct-text">✔ ${ans.userAnswer}</span>`
	: `<span class="summary-wrong-text">✖ ${ans.userAnswer}</span> <span style="margin: 0 5px; color:#999;">➔</span> <span class="real-answer">${ans.correctAnswer}</span>`
	}
	</div>
	</div>
	`;
	});
	

	

	html += `</div>`;
	app.innerHTML = html;
	}
	

	

	// --- LOGIC FUNCTIONS ---
	window.startQuestions = function() {
	state = 'question';
	currentQuestionIndex = 0;
	render();
	};
	

	

	window.handleAnswer = function(selectedIndex) {
	// Disable all buttons
	const buttons = document.querySelectorAll('.option-btn');
	buttons.forEach(b => b.disabled = true);
	

	

	const section = quizData[currentSectionIndex];
	const currentQ = section.questions[currentQuestionIndex];
	const isCorrect = selectedIndex === currentQ.correct;
	

	

	// Visual feedback on buttons
	const selectedBtn = document.getElementById(`opt-${selectedIndex}`);
	const correctBtn = document.getElementById(`opt-${currentQ.correct}`);
	

	

	if (isCorrect) {
	selectedBtn.classList.add('correct');
	} else {
	selectedBtn.classList.add('incorrect');
	correctBtn.classList.add('correct'); // Show which one was right
	}
	

	

	// Show feedback box
	const feedbackBox = document.getElementById('feedback');
	const feedbackTitle = document.getElementById('feedback-title');
	const feedbackText = document.getElementById('feedback-text');
	const nextBtn = document.getElementById('next-btn');
	

	

	feedbackBox.style.display = 'block';
	

	// Add class for success/error styling
	if (isCorrect) {
	feedbackBox.className = "feedback-box success";
	feedbackTitle.innerHTML = "Rätt svar!";
	} else {
	feedbackBox.className = "feedback-box error";
	feedbackTitle.innerHTML = "Inte riktigt...";
	}
	

	feedbackText.innerHTML = currentQ.explanation; // Use innerHTML to render <strong> tags
	

	

	// Check if last question of entire quiz
	const isLastQuestionOverall = (currentSectionIndex === quizData.length - 1) && (currentQuestionIndex === section.questions.length - 1);
	

	if(isLastQuestionOverall) {
	nextBtn.innerText = "Se resultat 🏁";
	} else if (currentQuestionIndex === section.questions.length - 1) {
	nextBtn.innerText = "Nästa del ➔";
	}
	

	

	// Scroll to feedback if needed on mobile, but gently
	const rect = feedbackBox.getBoundingClientRect();
	const isVisible = (rect.top >= 0) && (rect.bottom <= window.innerHeight);
	if (!isVisible) {
	setTimeout(() => {
	feedbackBox.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
	}, 100);
	}
	

	

	// Save data
	userAnswers.push({
	question: currentQ.q,
	userAnswer: currentQ.options[selectedIndex],
	correctAnswer: currentQ.options[currentQ.correct],
	isCorrect: isCorrect
	});
	};
	

	

	window.nextStep = function() {
	const section = quizData[currentSectionIndex];
	

	// Reset feedback styles for next render
	const feedbackBox = document.getElementById('feedback');
	if(feedbackBox) {
	feedbackBox.style.display = 'none';
	}
	

	

	// Check if there are more questions in this section
	if (currentQuestionIndex < section.questions.length - 1) {
	currentQuestionIndex++;
	render();
	} else {
	// End of section, move to next section
	if (currentSectionIndex < quizData.length - 1) {
	currentSectionIndex++;
	state = 'intro';
	render();
	} else {
	// End of quiz
	state = 'summary';
	render();
	}
	}
	};
	

	

	// --- INIT ---
	render();
	

	

	</script>
	

	

	</body>
	</html>